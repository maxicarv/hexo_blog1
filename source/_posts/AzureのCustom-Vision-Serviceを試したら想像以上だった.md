---
title: AzureのCustom Vision Serviceを試したら想像以上だった
set_disqus: false
categories:
  - AI
tags:
  - 機械学習
  - ディープラーニング
  - Azure Custom Vision Service
  - Microsoft
  - 本川じゃがいも
date: 2018-04-30 09:00:22
---
2月に[Japan IT Week 関西](https://www.japan-it.jp/kansai/sokuho/)へ赴き、主にAI関連のセミナーを受講してきたのだが、Microsoftの「AIの民主化」において、Azureの[Custom Vision Service](https://azure.microsoft.com/ja-jp/services/cognitive-services/custom-vision-service/)のデモンストレーションがそこそこの衝撃だった。セミナーではWebから適当に拾ってきたアリの画像と、とある特徴のあるアリ、それぞれ50、30枚の画像を用意し、ブラウザで登録して簡単な設定をした上で訓練開始。あっという間に必要十分と思える精度で特徴のあるアリを判別してみせた。設定は対象の写真の特徴をチェックボックスで選択するだけ。

そこそこの精度とはいえ、汎用の簡単な設定と100枚に満たない画僧だけで判別できてしまうとは。。。少なくとも百枚単位の画像データを用意し、設定値を試行錯誤するものだと勝手に思い込んでいた私には驚くべき結果だった。なので、さっそく帰るなり、手元の画像を使って試してみることに。

試してみたのは、私の住む地域で古くから伝わるジャガイモの種の識別。もともとディープラーニングの勉強の題材に使おうと種の写真をストックしておいたものがあったので、それとWeb上にあるジャガイモの画像を拝借して使用。[Custom Vision Serviceの使い方などは他に譲り](http://bit.ly/2qXgLiX)、試用した様子をば。

![ワークスペースの画面](/img/20180424-2.png "ワークスペース")

これが訓練イメージを登録したところ。左上の「honjaga」が地域の種、「potate」がWebから拝借した画像で、それぞれ58、25枚である。設定は何を選択していいのかわからなかったので汎用的に使えそうなデフォルト値（Generalだったか？）を選ぶ。じゃがいもなんて見た目にはこれといった特徴がないので、どの程度の結果が出るのか半信半疑で実行する。

![イテレーション（学習結果）](/img/20180424-1.png "イテレーション")

適合率、再現率とも高い値。

早速、学習したモデルを使って判定を実施。まずは地元のじゃがいも。
![結果１](/img/20180424-3.png "結果１")

どれも「potate」が0％。明確に判定できている。

続いて拝借したさまざまなじゃがいもの判定。
![結果２](/img/20180424-4.png "結果２")

「potate」である確率が低いものがあるものの、「honjaga」の確率は全て0％。これも明確に判定できている、と言っていいだろう。

おまけ。撮影ミスで、被写体を置く手を撮影してしまったもの。指の間から辛うじてジャガイモが見えているところ。
![おまけ：結果３](/img/20180424-5.png "おまけ：結果３")

この画像、撮影ミスでジャガイモを掴む手を映してしまったもの。なんと、これも「potate」の確率は0％。まあ、じゃがいも以外の特徴（背景色とか）から判別してるのだろうと思うが。。。

今回のお試しでは、地元のじゃがいもの画像が全体的に暗く土が残っているのに対し、拝借した画像の多くはきれいに洗浄されたじゃがいもで明るい画像が多かった。アルゴリズムが画像のどの特徴を捉えて判定しているかはブラックボックスだし、この結果を持って種の判定が容易に可能になったとは判断できない。しかし、当初想像していたよりもはるかに低コストで判定は可能であろう、という手ごたえが掴めたことは大きなモチベーションとなった。

ディープラーニングが「知らない人だけが損をする」時代になるのも目の前である。